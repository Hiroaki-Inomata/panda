<HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=iso-2022-jp">
<TITLE>自動更新カレンダー　その３</TITLE>
</HEAD>
<BODY bgcolor="#ffffff">
<SCRIPT language="JavaScript">
<!--
cldr = "";
day = new Date();
thisday = day.getDate();  //今日の日付 - 背景色を変更するため
day.setDate(1);       //今月最初の日にセット
month = day.getMonth() + 1;

year = day.getYear();
if(year < 2000) year += 1900;
numdays = new Array(31,28,31,30,31,30,31,31,30,31,30,31);

// うるう年
if((year%4 == 0) && (year%100 != 0) || (year%400 == 0)) numdays[1] = 29;

// 休日の定義
if(month == 1){holiday1 = 1; holiday2 = 14-(day.getDay()+5)%7; holiday3 = -1}  //成人の日
else if(month == 2){holiday1 = 11; holiday2 = -1; holiday3 = -1}
else if(month == 3){
  ed =  20.8431 + 0.242194 * (year - 1980) - Math.floor((year - 1980)/4);  //春分の日
  holiday1 = Math.floor(ed);
  holiday2 = -1;
  holiday3 = -1;
}
else if(month == 4){holiday1 = 29; holiday2 = -1; holiday3 = -1}
else if(month == 5){holiday1 = 3; holiday2 = 4; holiday3 = 5}
else if(month == 6){holiday1 = -1; holiday2 = -1; holiday3 = -1}
else if(month == 7){holiday1 = 20; holiday2 = -1; holiday3 = -1}
else if(month == 8){holiday1 = -1; holiday2 = -1; holiday3 = -1}
else if(month == 9){
  holiday1 = 15;
  ed =  23.2488 + 0.242194 * (year - 1980) - Math.floor((year - 1980)/4);  //秋分の日
  holiday2 = Math.floor(ed);
  holiday3 = -1
}
else if(month == 10){holiday1 = 14-(day.getDay()+5)%7;; holiday2 = -1; holiday3 = -1}  //体育の日
else if(month == 11){holiday1 = 3; holiday2 = 23; holiday3 = -1}
else if(month == 12){holiday1 = 23; holiday2 = -1; holiday3 = -1}
// 休日の定義終わり


// カレンダー本体
cldr += "<table border>";
cldr += "<tr align=center><th colspan=7>"+month+"月</th></tr>";
cldr += "<tr align=center><th><font color=\"#ff0000\">日</a></th><th>月</th><th>火</th><th>水</th><th>木</th><th>金</th><th><font color=\"#0000ff\">土</a></th></tr>";


// 日付の書き込み
for(sunday = 1-day.getDay(); sunday <= 31; sunday +=7){
  cldr += "<TR align=center>";
  for(i = sunday; i < sunday + 7; i++){
    if((i > 0) && (i <= numdays[month-1])){
      day.setDate(i);
      today = day.getDay();

      if(thisday == i) cldr += "<td bgcolor='#00ff00'>";    // 今日の背景色を緑にする
        else cldr += "<td>";

      if(today == 0){
        cldr += "<font color=\"#ff0000\">"+ i +"</font></td>";
      }else if((i == holiday1)||(i == holiday2)||(i == holiday3)){
        cldr += "<font color=\"#ff0000\">"+ i +"</font></td>";
      }else if((today == 1)&&((i-1 == holiday1)||(i-1 == holiday2)||(i-1 == holiday3))){
        cldr += "<font color=\"#ff0000\">"+ i +"</font></td>";
      }else if(today == 6){
        cldr += "<font color=\"#0000ff\">"+ i +"</font></TD>";
      }else{
        cldr += ""+ i +"</td>";
      }

    }else{
      cldr += "<td></td>";
    }
  }
  cldr += "</TR>";
}


cldr += "</TABLE>";

document.write(cldr);

// -->
</SCRIPT>
<br>
<hr>
</center>
</BODY>
</HTML>
