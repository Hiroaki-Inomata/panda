データベースのバッチデモについて

1. 動かし方

(0) PostgreSQLの準備を行う

・portmasterが起動出来ること
・ORCAというデータベースが存在していること

    $ psql < adrs.create

  適当にデータを作っておく。

    $ psql ORCA
    ORCA=>insert into adrs values('ogochan1','070-xxxx-7514','ogochan');
    ORCA=>insert into adrs values('ogochan2','070-xxxx-7514','ogochan');
    ORCA=>insert into adrs values('ogochan3','070-xxxx-7514','ogochan');
    ORCA=>\q

(1) pandaをbuildする

	$ ./configure --with-opencobol --with-dotcobol --with-postgres
	$ make

(2) アプリを起動する

	$ cd ./sample2
	$ ../aps/dbstub -db ORCA -bd sample SAMPLEB

	OpenCOBOLを使う場合には、アプリを起動する前に、

	$ export COB_LIBRARY_PATH=.:../aps/.libs/

	のようにして、OpenCOBOLのdynamic loading pathを指定しておくこと

2. 環境の説明

(1) ソース

  デモのソースは、./sample2にあります。このデモでは

	SAMPLEB.CBL

  のプログラムを使います。その他にdotCOBOLの場合は、

	MCPSUB.CBL

  をサブルーチンとして呼び出します。COPY句は適当に見て下さい
コンパイルするには、

	$ make all

と打てばCOPY句も含めて全てのファイルが生成されます。また、

	$ make -f Makefile.OC all

と打てばOpenCOBOLのコードを生成します

  COBOLプログラムは、EUCコードで保存される必要があります。文字が化ける時
は文字コードを調べてみます。

(2) レコード定義ファイル

	adrs.db
	metadb.db

(3) 起動パラメータ

  起動パラメータを見るには、各プログラムを-?というパラメータを指定して起
動して下さい。設定されているパラメータを表示して終了します。
